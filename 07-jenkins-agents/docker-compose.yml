version: '3.6'

volumes:
  agent01_data: {}
  slave02_data: {}

networks:
  jenkins_net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.31.9.0/24

services:
  agent01:
    image: jenkins/inbound-agent:alpine-jdk11
    hostname: agent01.magedu.com
    user: root
    environment:
      TZ: Asia/Shanghai
      JENKINS_URL: http://jenkins.magedu.com:8080
      JENKINS_AGENT_NAME: agent01.magedu.com
      JENKINS_AGENT_WORKDIR: /appdata/jenkins/
      JENKINS_SECRET: e91ea475faac4d734164802e7446c3c50bad9131d941d93e8c3cbe4ebf067251
      # SECRET is automatically generated by the master when adding agent01.
    volumes:
      - agent01_data:/appdata/jenkins/
    networks:
      jenkins_net:
        ipv4_address: 172.31.9.11
        aliases:
          - slave01
          - agent01
    extra_hosts:
      - "jenkins.magedu.com:${JENKINS_HOST_IP}"
    #restart: always

  agent02:
    image: jenkins/inbound-agent:alpine-jdk11
    hostname: agent02.magedu.com
    user: root
    environment:
      TZ: Asia/Shanghai
      JENKINS_URL: http://jenkins.magedu.com:8080
      JENKINS_AGENT_NAME: agent02.magedu.com
      JENKINS_AGENT_WORKDIR: /appdata/jenkins/
      JENKINS_SECRET: 87be0f8c1bea409acaef7c74d327fd61a133e075e93754b9f7b01b333f3ace15
      # SECRET is automatically generated by the master when adding agent02.
    volumes:
      - agent01_data:/appdata/jenkins/
    networks:
      jenkins_net:
        ipv4_address: 172.31.9.12
        aliases:
          - slave02
          - agent02
    extra_hosts:
      - "jenkins.magedu.com:${JENKINS_HOST_IP}"
    #restart: always
